function ASA = ASASetup(phi,startXs,stepCon,terminate)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                         %  %  ASA setup - Accelerated Stochastic Approximation.                      %%                                                                         %  %              ASA is a non-parametric adaptive procedure that, by quickly    %              reducing step size, rapidly converges to any accuracy level. %                                                                         %%                                                                         %%  Input:                                                                 % %  phi:              desired accuracy level, anywhere between 0 and 1.    % %  startXs:          initial 'stimulus level'(optimal near true trehshold)% %  stepCon:          suitably chosen stepping constant (idem)             % %  terminate:        stopping criterion. If terminate>10, ASA stops after %%                    a fixed number of trials. If value<10, criterion is a%%                    lower limit on stepsize. For instance, if the desired% %                    desired precision is 1.5 dB, ASA stops when stepsize %%                    reaches 0.5 dB. (Recomended by Treutwein, 1995.)     %% choosing constants:                                                     %  %                    startXs and stepCon are optimal near true threshold. %  %                    Note, however, that deviations below threshold cause %%                    cause big losses in efficiency, while deviations     %  %                    above threshold cause small losses in efficiency.    %  %                    Be generous.                                         %%                                                                         %  %   Basic info:                                                           %  % The ASA Staircase gradually decreases stepsize in two ways: for trial   %% n<3,following Robbins & Monro (1951), stepsize decreases proportionally %% to 1/n. For trial n>3, following Kesten (1958), stepsize changes        %  % as a function of M shift - the number of changes in 'responce category' % % (i.e. from consecutive correct to incorrect, or vice versa). As proven  %% by Hans Kesten, ASA converges to any value of phi between 0 and 1, with %  % a probability of 1.                                                     %%                                                                         %%                                             MH, okt. 2014               % %  Further reading:                                                       %%  Kesten, H. (1958). Accelerated stochastic approximation. The Annals of % %  Mathematical Statistics, 41-59.                                        % %  Robbins, H., & Monro, S. (1951). A stochastic approximation method. The%%  Annals of Mathematical Statistics, 400-407.                            % %  Treutwein, B. (1995). Adaptive psychophysical procedures. Vision       %%  Research, 35(17), 2503-2522.                                           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%ASA.ts = terminate;        if ASA.ts<10,              % static=FALSE,stop dynamically      ASA.static=0;          % staic=TRUE, stop at fixed number of trialselse                           ASA.static=1;          end                           ASA.stepcon = stepCon;     % optimal at treshold; safe at 1.2*tresholdASA.phi = phi;             % desired PHI (endpoint, e.g. 80% correct)ASA.X=startXs;             ASA.down = [];             % going down?                   (tracker)ASA.up = [];               % going up?                     (tracker)ASA.trend=[];              % consecutive response category?(tracker) ASA.trendbreuk=[];         % shift from CRC?               (tracker)ASA.mshift=0;              % nshift - change stepsize      (Kesten, 1958)ASA.step=[];ASA.keepgoing = 1;ASA.response = [];ASA.ntrial=0;